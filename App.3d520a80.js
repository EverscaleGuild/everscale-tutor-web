parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"yrjL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getUniqueId=exports.mergeTransactions=exports.AddressLiteral=exports.Address=void 0;class e{constructor(e){this.equals=(e=>this._equals(e)),this._address=e}toString(){return this._address}_equals(s){return s instanceof e?this._address==s._address:this._address==s}}exports.Address=e;class s extends e{constructor(e){super(e)}}function t(e,s,t){if("old"==t.batchType)return e.push(...s),e;if(0===e.length)return e.push(...s),e;let r=0;for(;r<e.length&&e[r].id.lt.localeCompare(t.maxLt)>=0;)++r;return e.splice(r,0,...s),e}exports.AddressLiteral=s,exports.mergeTransactions=t;const r=4294967295;let o=Math.floor(Math.random()*r);function d(){return o=(o+1)%r}exports.getUniqueId=d;
},{}],"S51G":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseTokensObject=exports.serializeTokensObject=exports.parseAccountInteraction=exports.parsePermissions=exports.parseMessage=exports.serializeMessage=exports.parseTransaction=exports.serializeTransaction=void 0;const e=require("./utils");function s(e){return{...e,inMessage:n(e.inMessage),outMessages:e.outMessages.map(n)}}function t(e){return{...e,inMessage:r(e.inMessage),outMessages:e.outMessages.map(r)}}function n(e){return{...e,src:e.src?e.src.toString():void 0,dst:e.dst?e.dst.toString():void 0}}function r(s){return{...s,src:s.src?new e.Address(s.src):void 0,dst:s.dst?new e.Address(s.dst):void 0}}function o(e){return{...e,accountInteraction:e.accountInteraction?i(e.accountInteraction):void 0}}function i(s){return{...s,address:new e.Address(s.address)}}function c(e){return a(e)}function a(s){if(s instanceof e.Address)return s.toString();if(Array.isArray(s)){const e=[];for(const t of s)e.push(a(t));return e}if(null!=s&&"object"==typeof s){const e={};for(const[t,n]of Object.entries(s))e[t]=a(n);return e}return s}function p(e,s){const t={};for(const n of e)t[n.name]=u(n,s[n.name]);return t}function u(s,t){if(s.type.startsWith("map")){let[e,n]=s.type.split(",");e=e.slice(4),n=n.slice(0,-1);const r=[];for(const[o,i]of t)r.push([u({name:"",type:e},o),u({name:"",type:n,components:s.components},i)]);return r}{const n=s.type.endsWith("[]"),r=!n&&s.type.startsWith("optional"),o=n?s.type.slice(0,-2):r?s.type.slice(9,-1):s.type;if(n){const e={name:s.name,type:o,components:s.components},n=[];for(const s of t)n.push(u(e,s));return n}if(r){if(null==t)return null;return u({name:s.name,type:o,components:s.components},t)}if("tuple"==o){const e={};if(null!=s.components)for(const n of s.components)e[n.name]=u(n,t[n.name]);return e}return"address"==o?new e.Address(t):t}}exports.serializeTransaction=s,exports.parseTransaction=t,exports.serializeMessage=n,exports.parseMessage=r,exports.parsePermissions=o,exports.parseAccountInteraction=i,exports.serializeTokensObject=c,exports.parseTokensObject=p;
},{"./utils":"yrjL"}],"qeQ0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Subscriber=void 0;const s=require("./utils");class t{constructor(s){this.provider=s,this.subscriptions={},this.scanners={},this.unsubscribe=(async()=>this._unsubscribe())}transactions(s){return this._addSubscription("transactionsFound",s,!1)}trace(t){const n=(0,s.getUniqueId)();return new i((s,e)=>{const i=new r(this,{origin:t,onData:s,onEnd:s=>{delete this.scanners[n],e(s)}});return this.scanners[n]=i,i.start(),Promise.resolve()},async()=>{const s=this.scanners[n];delete this.scanners[n],null!=s&&await s.stop()},e,!0)}oldTransactions(t,r){const o=(0,s.getUniqueId)();return new i((s,e)=>{const i=new n(this.provider,{address:t,onData:s,onEnd:s=>{delete this.scanners[o],e(s)},...r});return this.scanners[o]=i,i.start(),Promise.resolve()},async()=>{const s=this.scanners[o];delete this.scanners[o],null!=s&&await s.stop()},e,!0)}states(s){return this._addSubscription("contractStateChanged",s,!1)}async _unsubscribe(){const s=Object.assign({},this.subscriptions);for(const e of Object.keys(this.subscriptions))delete this.subscriptions[e];const t=Object.assign({},this.scanners);for(const e of Object.keys(this.scanners))delete this.scanners[e];await Promise.all(Object.values(s).map(async s=>{const t=Object.assign({},s);for(const e of Object.keys(t))delete s[e];await Promise.all(Object.values(t).map(s=>{if(null!=s)return s.subscription.then(s=>s.unsubscribe()).catch(()=>{})}))}).concat(Object.values(t).map(s=>s.stop())))}_addSubscription(t,n,r){const c=n.toString(),a=s=>{const e=this.subscriptions[c];if(null==e)return;const i=e[t];if(null!=i){const n=i.handlers[s];if(null!=n){delete i.handlers[s];const{queue:t,onEnd:e,state:r}=n;r.finished||(r.finished=!0,t.clear(),t.enqueue(async()=>e(r.eof)))}if(0===Object.keys(i.handlers).length){const s=i.subscription;delete e[t],s.then(s=>s.unsubscribe()).catch(console.debug)}}0===Object.keys(e).length&&delete this.subscriptions[c]},u=(0,s.getUniqueId)().toString();return new i((s,e)=>{let i=this.subscriptions[c],r=null==i?void 0:i[t];const h={onData:s,onEnd:e,queue:new o,state:{eof:!1,finished:!1}};if(null!=r)return r.handlers[u]=h,Promise.resolve();const d={[u]:h},l=this.provider.subscribe(t,{address:n}).then(s=>(s.on("data",s=>{Object.values(d).forEach(({onData:t,queue:e,state:i})=>{i.eof||i.finished||e.enqueue(async()=>{await t(s)||(i.eof=!0,a(u))})})}),s.on("unsubscribed",()=>{Object.keys(d).forEach(a)}),s)).catch(s=>{throw console.error(s),Object.keys(d).forEach(a),s});return r={subscription:l,handlers:d},null==i?this.subscriptions[c]={[t]:r}:i[t]=r,l.then(()=>{})},()=>a(u),e,r)}}async function e(s,t){return t(s)}exports.Subscriber=t;class i{constructor(s,t,e,i){this.makeProducer=s,this.stopProducer=t,this.extractor=e,this.isFinite=i,this.fold=this.onlyFinite((s,t,e)=>{let i=s;return new Promise((s,n)=>{const r=this.makeProducer(s=>this.extractor(s,async s=>(i=await t(i,s),!0)),t=>{t?s(i):n(new Error("Subscription closed"))});null!=e&&(e.subscribed=r)})}),this.finished=this.onlyFinite(s=>new Promise((t,e)=>{const i=this.makeProducer(s=>this.extractor(s,s=>!0),s=>{s?t(void 0):e(new Error("Subscription closed"))});null!=s&&(s.subscribed=i)}))}async delayed(s){const{subscribed:t,result:e}=s({first:()=>{const s={},t=this.first(s);return{subscribed:s.subscribed,result:t}},on:s=>{const t={};return this.on(s,t),{subscribed:t.subscribed,result:void 0}},fold:null!=this.fold?(s,t)=>{const e={},i=this.fold(s,t,e);return{subscribed:e.subscribed,result:i}}:void 0,finished:null!=this.finished?()=>{const s={},t=this.finished(s);return{subscribed:s.subscribed,result:t}}:void 0});return await t,()=>e}first(s){let t={found:!1};return new Promise((e,i)=>{const n=this.makeProducer(s=>this.extractor(s,s=>(Object.assign(t,{found:!0,result:s}),!1)),s=>{s?this.isFinite?e(t.found?t.result:void 0):t.found?e(t.result):i(new Error("Unexpected end of stream")):i(new Error("Subscription closed"))});null!=s&&(s.subscribed=n)})}on(s,t){const e=this.makeProducer(t=>this.extractor(t,async t=>(await s(t),!0)),s=>{});null!=t&&(t.subscribed=e)}merge(s){return new i((t,e)=>{const i={stopped:!1,counter:0},n=s=>{i.stopped||2!=++i.counter&&s||(i.stopped=!0,e(s))};return Promise.all([this.makeProducer(t,n),s.makeProducer(t,n)]).then(()=>{})},()=>{this.stopProducer(),s.stopProducer()},this.extractor,this.isFinite&&s.isFinite)}enumerate(){const s={index:0};return new i(this.makeProducer,this.stopProducer,(t,e)=>this.extractor(t,async t=>e({index:s.index++,item:t})),this.isFinite)}tap(s){return new i(this.makeProducer,this.stopProducer,(t,e)=>this.extractor(t,async t=>(await s(t),e(t))),this.isFinite)}filter(s){return new i(this.makeProducer,this.stopProducer,(t,e)=>this.extractor(t,async t=>!(await s(t))||e(t)),this.isFinite)}filterMap(s){return new i(this.makeProducer,this.stopProducer,(t,e)=>this.extractor(t,async t=>{const i=await s(t);return void 0===i||e(i)}),this.isFinite)}map(s){return new i(this.makeProducer,this.stopProducer,(t,e)=>this.extractor(t,async t=>{const i=await s(t);return e(i)}),this.isFinite)}flatMap(s){return new i(this.makeProducer,this.stopProducer,(t,e)=>this.extractor(t,async t=>{const i=await s(t);for(const s of i)if(!(await e(s)))return!1;return!0}),this.isFinite)}skip(s){const t={index:0};return new i(this.makeProducer,this.stopProducer,(e,i)=>this.extractor(e,e=>t.index>=s?i(e):(++t.index,!0)),this.isFinite)}skipWhile(s){const t={shouldSkip:!0};return new i(this.makeProducer,this.stopProducer,(e,i)=>this.extractor(e,async e=>!(!t.shouldSkip||!(await s(e)))||(t.shouldSkip=!1,i(e))),this.isFinite)}take(s){const t={index:0};return new i(this.makeProducer,this.stopProducer,(e,i)=>this.extractor(e,e=>t.index<s&&(++t.index,i(e))),!0)}takeWhile(s){return new i(this.makeProducer,this.stopProducer,(t,e)=>this.extractor(t,async t=>!!(await s(t))&&e(t)),!0)}takeWhileMap(s){return new i(this.makeProducer,this.stopProducer,(t,e)=>this.extractor(t,async t=>{const i=await s(t);return void 0!==i&&e(i)}),!0)}onlyFinite(s){return this.isFinite?s:void 0}}class n{constructor(s,t){this.provider=s,this.params=t,this.queue=new o,this.isRunning=!1}start(){this.isRunning||null!=this.promise||(this.isRunning=!0,this.promise=(async()=>{const s=this.params;let t={complete:!1};for(;this.isRunning&&!t.complete;)try{const{transactions:i,continuation:n}=await this.provider.getTransactions({address:this.params.address,continuation:this.continuation});if(t.complete=!t.complete&&null==i.length,!this.isRunning||t.complete)break;const r=i.filter(t=>(null==s.fromLt||t.id.lt>s.fromLt)&&(null==s.fromUtime||t.createdAt>s.fromUtime));if(0==r.length){t.complete=!0;break}const o=r.filter(t=>(null==s.toLt||t.id.lt<s.toLt)&&(null==s.toUtime||t.createdAt<s.toUtime));if(o.length>0){const s={maxLt:o[0].id.lt,minLt:o[o.length-1].id.lt,batchType:"old"};this.queue.enqueue(async()=>{this.params.onData({address:this.params.address,transactions:o,info:s})||(t.complete=!0,this.isRunning=!1)})}if(null==n){t.complete=!0;break}this.continuation=n}catch(e){console.error(e)}this.queue.enqueue(async()=>this.params.onEnd(t.complete)),this.isRunning=!1,this.continuation=void 0})())}async stop(){this.isRunning=!1,this.queue.clear(),null!=this.promise?await this.promise:this.params.onEnd(!1)}}class r{constructor(s,t){this.subscriber=s,this.params=t,this.queue=new o,this.isRunning=!1,this.streams=new Map,this.pendingTransactions=new Map}start(){if(this.isRunning||null!=this.promise)return;const s=this.subscriber;this.isRunning=!0,this.promise=(async()=>{const t={complete:!1},e=this.params.origin.id.lt,i=t=>{for(const i of t.outMessages){if(null==i.dst)continue;const t=i.dst.toString();if(this.streams.has(t))continue;const n=s.oldTransactions(i.dst,{fromLt:e}).merge(s.transactions(i.dst)).flatMap(({address:s,transactions:t})=>t.map(t=>(t.account=s,t)));this.streams.set(t,n),n.on(s=>{const t=s.inMessage.hash,e=this.pendingTransactions.get(t);null==e?this.pendingTransactions.set(t,{promise:Promise.resolve(s),resolve:()=>{},reject:()=>{}}):e.resolve(s)})}},n=[this.params.origin];try{s:for(;this.isRunning;){const s=n.shift();if(null==s){t.complete=!0;break}i(s);for(const e of s.outMessages){if(null==e.dst)continue;const s=this.pendingTransactions.get(e.hash);let i;if(null==s){let s,t;const n=new Promise((e,i)=>{s=(s=>e(s)),t=(()=>i())});this.pendingTransactions.set(e.hash,{promise:n,resolve:s,reject:t}),i=n}else i=s.promise;const r=await i;if(!this.isRunning||t.complete)break s;this.queue.enqueue(async()=>{this.params.onData(r)||(t.complete=!0,this.isRunning=!1,this.rejectPendingTransactions())}),n.push(r)}}}catch(r){}finally{this.queue.enqueue(async()=>this.params.onEnd(t.complete)),this.isRunning=!1;for(const s of this.streams.values())s.stopProducer()}})()}async stop(){this.isRunning=!1,this.queue.clear(),this.rejectPendingTransactions(),null!=this.promise?await this.promise:this.params.onEnd(!1)}rejectPendingTransactions(){for(const s of this.pendingTransactions.values())s.reject()}}class o{constructor(){this.queue=[],this.workingOnPromise=!1}enqueue(s){this.queue.push(s),this._dequeue().catch(()=>{})}clear(){this.queue.length=0}async _dequeue(){if(this.workingOnPromise)return;const s=this.queue.shift();s&&(this.workingOnPromise=!0,s().then(()=>{this.workingOnPromise=!1,this._dequeue()}).catch(()=>{this.workingOnPromise=!1,this._dequeue()}))}}
},{"./utils":"yrjL"}],"Xnvh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TvmException=exports.Contract=void 0;const t=require("./models");class e{constructor(e,s,n){if(!Array.isArray(s.functions))throw new Error("Invalid abi. Functions array required");if(!Array.isArray(s.events))throw new Error("Invalid abi. Events array required");this._provider=e,this._abi=JSON.stringify(s),this._functions=s.functions.reduce((t,e)=>(t[e.name]={inputs:e.inputs||[],outputs:e.outputs||[]},t),{}),this._events=s.events.reduce((t,e)=>(t[e.name]={inputs:e.inputs||[]},t),{}),this._address=n;class a{constructor(e,i,s,n,a,r){this.provider=e,this.functionAbi=i,this.abi=s,this.address=n,this.method=a,this.params=(0,t.serializeTokensObject)(r)}async send(e){await this.provider.ensureInitialized();const{transaction:i}=await this.provider.rawApi.sendMessage({sender:e.from.toString(),recipient:this.address.toString(),amount:e.amount,bounce:null==e.bounce||e.bounce,payload:{abi:this.abi,method:this.method,params:this.params}});return(0,t.parseTransaction)(i)}async sendWithResult(e){await this.provider.ensureInitialized();let i=e.subscriber;const s=null==i;null==i&&(i=new this.provider.Subscriber);try{let a,r;const o=new Promise(t=>{r=(e=>t(e))}),u=[];i.transactions(this.address).flatMap(t=>t.transactions).filter(t=>{var i;return(null===(i=t.inMessage.src)||void 0===i?void 0:i.equals(e.from))||!1}).on(t=>{null==a?u.push(t):a.possibleMessages.findIndex(e=>e.hash==t.inMessage.hash)>=0&&(null==r||r(t))});const d=await this.send(e),l=d.outMessages.filter(t=>{var e;return(null===(e=t.dst)||void 0===e?void 0:e.equals(this.address))||!1});a={transaction:d,possibleMessages:l};const c=u.find(t=>l.findIndex(e=>e.hash==t.inMessage.hash)>=0);null!=c&&(null==r||r(c));const h=await o;let p=void 0;try{const e=await this.provider.rawApi.decodeTransaction({transaction:(0,t.serializeTransaction)(h),abi:this.abi,method:this.method});null!=e&&(p=null!=this.functionAbi.outputs?(0,t.parseTokensObject)(this.functionAbi.outputs,e.output):{})}catch(n){console.error(n)}return{parentTransaction:a.transaction,childTransaction:h,output:p}}finally{s&&await i.unsubscribe()}}async estimateFees(t){await this.provider.ensureInitialized();const{fees:e}=await this.provider.rawApi.estimateFees({sender:t.from.toString(),recipient:this.address.toString(),amount:t.amount,payload:{abi:this.abi,method:this.method,params:this.params}});return e}async sendExternal(e){await this.provider.ensureInitialized();let i=!0===e.withoutSignature?this.provider.rawApi.sendUnsignedExternalMessage:this.provider.rawApi.sendExternalMessage,{transaction:s,output:n}=await i({publicKey:e.publicKey,recipient:this.address.toString(),stateInit:e.stateInit,payload:{abi:this.abi,method:this.method,params:this.params},local:e.local});return{transaction:(0,t.parseTransaction)(s),output:null!=n?(0,t.parseTokensObject)(this.functionAbi.outputs,n):void 0}}async call(e={}){await this.provider.ensureInitialized();let{output:s,code:n}=await this.provider.rawApi.runLocal({address:this.address.toString(),cachedState:e.cachedState,responsible:e.responsible,functionCall:{abi:this.abi,method:this.method,params:this.params}});if(null==s||0!=n)throw new i(n);return(0,t.parseTokensObject)(this.functionAbi.outputs,s)}async encodeInternal(){await this.provider.ensureInitialized();let{boc:t}=await this.provider.rawApi.encodeInternalInput({abi:this.abi,method:this.method,params:this.params});return t}}this._methods=new Proxy({},{get:(t,e)=>{const i=this._functions[e];return t=>new a(this._provider,i,this._abi,this._address,e,t)}})}get methods(){return this._methods}get address(){return this._address}get abi(){return this._abi}async waitForEvent(t={}){const{range:e,filter:i}=t;let s=t.subscriber;const n=null==s;null==s&&(s=new this._provider.Subscriber);const a=await(null!=(null==e?void 0:e.fromLt)||null!=(null==e?void 0:e.fromUtime)?s.oldTransactions(this._address,e).merge(s.transactions(this._address)):s.transactions(this.address)).flatMap(t=>t.transactions).takeWhile(t=>null==e||(null==e.fromLt||t.id.lt>e.fromLt)&&(null==e.fromUtime||t.createdAt>e.fromUtime)&&(null==e.toLt||t.id.lt<e.toLt)&&(null==e.toUtime||t.createdAt<e.toUtime)).flatMap(t=>this.decodeTransactionEvents({transaction:t}).then(e=>(e.forEach(e=>e.transaction=t),e))).filterMap(async t=>null==i||await i(t)?t:void 0).first();return n&&await s.unsubscribe(),a}async getPastEvents(t){const{range:e,filter:i,limit:s}=t;let n=[],a=null==t?void 0:t.continuation;t:for(;;){const{transactions:t,continuation:r}=await this._provider.getTransactions({address:this._address,continuation:a});if(null===t.length)break;const o=t.filter(t=>(null==(null==e?void 0:e.fromLt)||t.id.lt>e.fromLt)&&(null==(null==e?void 0:e.fromUtime)||t.createdAt>e.fromUtime)&&(null==(null==e?void 0:e.toLt)||t.id.lt<(null==e?void 0:e.toLt))&&(null==(null==e?void 0:e.toUtime)||t.createdAt<(null==e?void 0:e.toUtime)));if(o.length>0){const t=await Promise.all(o.map(async t=>({tx:t,events:await this.decodeTransactionEvents({transaction:t}).then(e=>(e.forEach(e=>e.transaction=t),e))})));for(let{tx:e,events:r}of t){null!=i&&(r=await Promise.all(r.map(async t=>await i(t)?t:void 0)).then(t=>t.filter(t=>null!=t))),a=e.id;for(const t of r){if(null!=s&&n.length>=s)break t;n.push(t)}if(null!=s&&n.length>=s)break t}}if(null==(a=r))break}return{events:n,continuation:a}}async decodeTransaction(e){await this._provider.ensureInitialized();try{const s=await this._provider.rawApi.decodeTransaction({transaction:(0,t.serializeTransaction)(e.transaction),abi:this._abi,method:e.methods});if(null==s)return;let{method:n,input:a,output:r}=s;const o=this._functions[n];return{method:n,input:null!=o.inputs?(0,t.parseTokensObject)(o.inputs,a):{},output:null!=o.outputs?(0,t.parseTokensObject)(o.outputs,r):{}}}catch(i){return}}async decodeTransactionEvents(e){await this._provider.ensureInitialized();try{const{events:s}=await this._provider.rawApi.decodeTransactionEvents({transaction:(0,t.serializeTransaction)(e.transaction),abi:this._abi}),n=[];for(const{event:e,data:i}of s){const s=this._events[e];n.push({event:e,data:null!=s.inputs?(0,t.parseTokensObject)(s.inputs,i):{}})}return n}catch(i){return[]}}async decodeInputMessage(e){await this._provider.ensureInitialized();try{const s=await this._provider.rawApi.decodeInput({abi:this._abi,body:e.body,internal:e.internal,method:e.methods});if(null==s)return;let{method:n,input:a}=s;const r=this._functions[n];return{method:n,input:null!=r.inputs?(0,t.parseTokensObject)(r.inputs,a):{}}}catch(i){return}}async decodeOutputMessage(e){await this._provider.ensureInitialized();try{const s=await this._provider.rawApi.decodeOutput({abi:this._abi,body:e.body,method:e.methods});if(null==s)return;let{method:n,output:a}=s;const r=this._functions[n];return{method:n,output:null!=r.outputs?(0,t.parseTokensObject)(r.outputs,a):{}}}catch(i){return}}async decodeEvent(e){await this._provider.ensureInitialized();try{const s=await this._provider.rawApi.decodeEvent({abi:this.abi,body:e.body,event:e.events});if(null==s)return;let{event:n,data:a}=s;const r=this._events[n];return{event:n,data:null!=r.inputs?(0,t.parseTokensObject)(r.inputs,a):{}}}catch(i){return}}}exports.Contract=e;class i extends Error{constructor(t){super(`TvmException: ${t}`),this.code=t}}exports.TvmException=i;
},{"./models":"S51G"}],"mEq5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});
},{}],"RebX":[function(require,module,exports) {
"use strict";var t=this&&this.__createBinding||(Object.create?function(t,e,s,i){void 0===i&&(i=s);var a=Object.getOwnPropertyDescriptor(e,s);a&&("get"in a?e.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return e[s]}}),Object.defineProperty(t,i,a)}:function(t,e,s,i){void 0===i&&(i=s),t[i]=e[s]}),e=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var i={};if(null!=s)for(var a in s)"default"!==a&&Object.prototype.hasOwnProperty.call(s,a)&&t(i,s,a);return e(i,s),i},i=this&&this.__exportStar||function(e,s){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(s,i)||t(s,e,i)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProviderNotInitializedException=exports.ProviderNotFoundException=exports.ProviderRpcClient=exports.hasEverscaleProvider=exports.mergeTransactions=exports.AddressLiteral=exports.Address=exports.Subscriber=void 0;const a=require("./models"),r=require("./utils"),n=s(require("./stream")),o=s(require("./contract"));i(require("./api"),exports),i(require("./models"),exports),i(require("./contract"),exports);var c=require("./stream");Object.defineProperty(exports,"Subscriber",{enumerable:!0,get:function(){return c.Subscriber}});var d=require("./utils");Object.defineProperty(exports,"Address",{enumerable:!0,get:function(){return d.Address}}),Object.defineProperty(exports,"AddressLiteral",{enumerable:!0,get:function(){return d.AddressLiteral}}),Object.defineProperty(exports,"mergeTransactions",{enumerable:!0,get:function(){return d.mergeTransactions}});const u="undefined"!=typeof window&&void 0!==window.document;let l;l=u&&"complete"!=document.readyState?new Promise(t=>{window.addEventListener("load",()=>{t()})}):Promise.resolve();const p=()=>u?window.__ever||window.ton:void 0;async function h(){return!!u&&(await l,!0===window.__hasEverscaleProvider||!0===window.hasTonProvider)}exports.hasEverscaleProvider=h;class w{constructor(t={}){this._subscriptions={},this._contractSubscriptions={},this._properties=t;const e=this;this.Contract=class extends o.Contract{constructor(t,s){super(e,t,s)}};this.Subscriber=class extends n.Subscriber{constructor(){super(e)}},this._api=new Proxy({},{get:(t,e)=>t=>{if(null!=this._provider)return this._provider.request({method:e,params:t});throw new _}}),!0===t.forceUseFallback?this._initializationPromise=null!=t.fallback?t.fallback().then(t=>{this._provider=t}):Promise.resolve():(this._provider=p(),null!=this._provider?this._initializationPromise=Promise.resolve():this._initializationPromise=h().then(t=>new Promise(e=>{if(!t)return e();if(this._provider=p(),null!=this._provider)e();else{const t=!0===window.__hasEverscaleProvider?"ever#initialized":"ton#initialized";window.addEventListener(t,t=>{this._provider=p(),e()})}})).then(async()=>{null==this._provider&&null!=t.fallback&&(this._provider=await t.fallback())})),this._initializationPromise.then(()=>{null!=this._provider&&this._registerEventHandlers(this._provider)})}async hasProvider(){return null!=this._properties.fallback||h()}async ensureInitialized(){if(await this._initializationPromise,null==this._provider)throw new b}get isInitialized(){return null!=this._provider}get raw(){if(null!=this._provider)return this._provider;throw new _}get rawApi(){return this._api}createContract(t,e){return new this.Contract(t,e)}createSubscriber(){return new this.Subscriber}async requestPermissions(t){await this.ensureInitialized();const e=await this._api.requestPermissions({permissions:t.permissions});return(0,a.parsePermissions)(e)}async changeAccount(){await this.ensureInitialized(),await this._api.changeAccount()}async disconnect(){await this.ensureInitialized(),await this._api.disconnect()}async subscribe(t,e){class s{constructor(t,e){this._subscribe=t,this._unsubscribe=e,this._listeners={data:[],subscribed:[],unsubscribed:[]},this._subscribed=!1,this.subscribe=(async()=>{if(!this._subscribed){this._subscribed=!0,await this._subscribe(this);for(const t of this._listeners.subscribed)t()}}),this.unsubscribe=(async()=>{if(this._subscribed){this._subscribed=!1,await this._unsubscribe();for(const t of this._listeners.unsubscribed)t()}})}on(t,e){return this._listeners[t].push(e),this}notify(t){for(const e of this._listeners.data)e(t)}}let i=this._getEventSubscriptions(t);const a=(0,r.getUniqueId)();switch(t){case"connected":case"disconnected":case"networkChanged":case"permissionsChanged":case"loggedOut":{const t=new s(async t=>{null==i[a]&&(i[a]=(e=>{t.notify(e)}))},async()=>{delete i[a]});return await t.subscribe(),t}case"transactionsFound":case"contractStateChanged":{await this.ensureInitialized();const r=e.address.toString(),n=new s(async e=>{if(null!=i[a])return;i[a]=(t=>{t.address.toString()==r&&e.notify(t)});let s=this._contractSubscriptions[r];null==s&&(s={},this._contractSubscriptions[r]=s),s[a]={state:"contractStateChanged"==t,transactions:"transactionsFound"==t};const{total:n,withoutExcluded:o}=y(Object.values(s),s[a]);try{n.transactions==o.transactions&&n.state==o.state||await this.rawApi.subscribe({address:r,subscriptions:n})}catch(c){throw delete i[a],delete s[a],c}},async()=>{delete i[a];const t=this._contractSubscriptions[r];if(null==t)return;const e=t[a],{total:s,withoutExcluded:n}=y(Object.values(t),e);delete t[a],n.transactions||n.state?s.transactions==n.transactions&&s.state==n.state||await this.rawApi.subscribe({address:r,subscriptions:n}):await this.rawApi.unsubscribe({address:r})});return await n.subscribe(),n}default:throw new Error(`Unknown event ${t}`)}}async getProviderState(){await this.ensureInitialized();const t=await this._api.getProviderState();return{...t,permissions:(0,a.parsePermissions)(t.permissions)}}async getBalance(t){const{state:e}=await this.getFullContractState({address:t});return null==e?"0":null==e?void 0:e.balance}async getFullContractState(t){return await this.ensureInitialized(),await this._api.getFullContractState({address:t.address.toString()})}async getAccountsByCodeHash(t){await this.ensureInitialized();const{accounts:e,continuation:s}=await this._api.getAccountsByCodeHash({...t});return{accounts:e.map(t=>new r.Address(t)),continuation:s}}async getTransactions(t){await this.ensureInitialized();const{transactions:e,continuation:s,info:i}=await this._api.getTransactions({...t,address:t.address.toString()});return{transactions:e.map(a.parseTransaction),continuation:s,info:i}}async getTransaction(t){await this.ensureInitialized();const{transaction:e}=await this._api.getTransaction({...t});return{transaction:e?(0,a.parseTransaction)(e):void 0}}async getExpectedAddress(t,e){const{address:s}=await this.getStateInit(t,e);return s}async getStateInit(t,e){await this.ensureInitialized();const{address:s,stateInit:i}=await this._api.getExpectedAddress({abi:JSON.stringify(t),...e,initParams:(0,a.serializeTokensObject)(e.initParams)});return{address:new r.Address(s),stateInit:i}}async getBocHash(t){return await this.ensureInitialized(),await this._api.getBocHash({boc:t}).then(({hash:t})=>t)}async packIntoCell(t){return await this.ensureInitialized(),await this._api.packIntoCell({structure:t.structure,data:(0,a.serializeTokensObject)(t.data)})}async unpackFromCell(t){await this.ensureInitialized();const{data:e}=await this._api.unpackFromCell({...t,structure:t.structure});return{data:(0,a.parseTokensObject)(t.structure,e)}}async extractPublicKey(t){await this.ensureInitialized();const{publicKey:e}=await this._api.extractPublicKey({boc:t});return e}async codeToTvc(t){await this.ensureInitialized();const{tvc:e}=await this._api.codeToTvc({code:t});return e}async mergeTvc(t){return await this.ensureInitialized(),await this._api.mergeTvc(t)}async splitTvc(t){return await this.ensureInitialized(),await this._api.splitTvc({tvc:t})}async setCodeSalt(t){let e;if("string"==typeof t.salt)await this.ensureInitialized(),e=t.salt;else{const{boc:s}=await this.packIntoCell(t.salt);e=s}return await this._api.setCodeSalt({code:t.code,salt:e})}async getCodeSalt(t){await this.ensureInitialized();const{salt:e}=await this.rawApi.getCodeSalt({code:t.code});return e}async addAsset(t){let e;switch(await this.ensureInitialized(),t.type){case"tip3_token":e={rootContract:t.params.rootContract.toString()};break;default:throw new Error("Unknown asset type")}return await this._api.addAsset({account:t.account.toString(),type:t.type,params:e})}async verifySignature(t){return await this.ensureInitialized(),await this._api.verifySignature(t)}async signData(t){return await this.ensureInitialized(),await this._api.signData(t)}async signDataRaw(t){return await this.ensureInitialized(),await this._api.signDataRaw(t)}async encryptData(t){await this.ensureInitialized();const{encryptedData:e}=await this._api.encryptData(t);return e}async decryptData(t){await this.ensureInitialized();const{data:e}=await this._api.decryptData({encryptedData:t});return e}async sendMessage(t){await this.ensureInitialized();const{transaction:e}=await this._api.sendMessage({...t,sender:t.sender.toString(),recipient:t.recipient.toString(),payload:t.payload?{abi:t.payload.abi,method:t.payload.method,params:(0,a.serializeTokensObject)(t.payload.params)}:void 0});return{transaction:(0,a.parseTransaction)(e)}}_registerEventHandlers(t){const e={connected:t=>t,disconnected:t=>t,transactionsFound:t=>({address:new r.Address(t.address),transactions:t.transactions.map(a.parseTransaction),info:t.info}),contractStateChanged:t=>({address:new r.Address(t.address),state:t.state}),networkChanged:t=>t,permissionsChanged:t=>({permissions:(0,a.parsePermissions)(t.permissions)}),loggedOut:t=>t};for(const[s,i]of Object.entries(e))t.addListener(s,t=>{const e=this._subscriptions[s];if(null==e)return;const a=i(t);for(const s of Object.values(e))s(a)})}_getEventSubscriptions(t){let e=this._subscriptions[t];return null==e&&(e={},this._subscriptions[t]=e),e}}exports.ProviderRpcClient=w;class b extends Error{constructor(){super("Everscale provider was not found")}}exports.ProviderNotFoundException=b;class _ extends Error{constructor(){super("Everscale provider was not initialized yet")}}function y(t,e){const s={state:!1,transactions:!1},i=Object.assign({},s);for(const a of t){if(i.transactions&&i.state)break;s.state||(s.state=a.state),s.transactions||(s.transactions=a.transactions),a!=e&&(i.state||(i.state=a.state),i.transactions||(i.transactions=a.transactions))}return{total:s,withoutExcluded:i}}exports.ProviderNotInitializedException=_;
},{"./models":"S51G","./utils":"yrjL","./stream":"qeQ0","./contract":"Xnvh","./api":"mEq5"}],"tKmd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={"ABI version":2,version:"2.2",header:["time","expire"],functions:[{name:"constructor",inputs:[],outputs:[]},{name:"destruct",inputs:[{name:"beneficiary",type:"address"}],outputs:[]},{name:"renderHelloWorld",inputs:[],outputs:[{name:"value0",type:"string"}]},{name:"touch",inputs:[],outputs:[]},{name:"send",inputs:[{name:"dest",type:"address"},{name:"value",type:"uint128"}],outputs:[]},{name:"timestamp",inputs:[],outputs:[{name:"timestamp",type:"uint32"}]}],data:[],events:[],fields:[{name:"_pubkey",type:"uint256"},{name:"_timestamp",type:"uint64"},{name:"_constructorFlag",type:"bool"},{name:"timestamp",type:"uint32"}]};
},{}],"V370":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={testnet:{App:"0:a207f69127eec08c40d016ea88b731b6cf09e4725b36b39c59e8000ca4616bfe"}};
},{}],"H6gL":[function(require,module,exports) {
"use strict";var n=this&&this.__awaiter||function(n,e,t,r){return new(t||(t=Promise))(function(c,o){function s(n){try{a(r.next(n))}catch(e){o(e)}}function i(n){try{a(r.throw(n))}catch(e){o(e)}}function a(n){var e;n.done?c(n.value):(e=n.value,e instanceof t?e:new t(function(n){n(e)})).then(s,i)}a((r=r.apply(n,e||[])).next())})},e=this&&this.__generator||function(n,e){var t,r,c,o,s={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(c=2&o[0]?r.return:o[0]?r.throw||((c=r.return)&&c.call(r),0):r.next)&&!(c=c.call(r,o[1])).done)return c;switch(r=0,c&&(o=[2&o[0],c.value]),o[0]){case 0:case 1:c=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(c=(c=s.trys).length>0&&c[c.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!c||o[1]>c[0]&&o[1]<c[3])){s.label=o[1];break}if(6===o[0]&&s.label<c[1]){s.label=c[1],c=o;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(o);break}c[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(n,s)}catch(i){o=[6,i],r=0}finally{t=c=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},t=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("everscale-inpage-provider"),c=t(require("../build/App.abi")),o=t(require("../build/App.addr")),s=new r.ProviderRpcClient;function i(n,e){document.querySelectorAll("[data-behavior=".concat(n,"]")).forEach(e)}var a=function(n){return function(e){e.innerText=n}};function u(){return n(this,void 0,void 0,function(){var n,t,r;return e(this,function(e){switch(e.label){case 0:return[4,y()];case 1:n=e.sent(),e.label=2;case 2:return e.trys.push([2,4,,5]),[4,n.methods.timestamp({}).call()];case 3:return t=e.sent(),i("out",a(t.timestamp)),[3,5];case 4:return r=e.sent(),console.error(r),[3,5];case 5:return[2]}})})}function l(){return n(this,void 0,void 0,function(){var n,t,r;return e(this,function(e){switch(e.label){case 0:return[4,y()];case 1:n=e.sent(),e.label=2;case 2:return e.trys.push([2,4,,5]),[4,n.methods.renderHelloWorld({}).call()];case 3:return t=e.sent(),i("out",a(t.value0)),[3,5];case 4:return r=e.sent(),console.error(r),[3,5];case 5:return[2]}})})}function d(){return n(this,void 0,void 0,function(){var n,t,r,c,o,a,u,l,d;return e(this,function(e){switch(e.label){case 0:return[4,y()];case 1:return n=e.sent(),[4,s.getProviderState()];case 2:t=e.sent(),r=t.permissions.accountInteraction.publicKey,console.error("touchAction publicKey=".concat(r)),e.label=3;case 3:return e.trys.push([3,6,,7]),[4,n.methods.touch({}).sendExternal({publicKey:r,withoutSignature:!0})];case 4:return c=e.sent(),console.log(c),o=c.transaction,l=(u="aborted=".concat(o.aborted,' <a href="')).concat,[4,f(o.id.hash)];case 5:return a=l.apply(u,[e.sent(),'">trx=']).concat(o.id.hash,"</a>"),i("out",function(n){return n.innerHTML=a}),[3,7];case 6:return d=e.sent(),console.error(d),[3,7];case 7:return[2]}})})}function f(t){return n(this,void 0,void 0,function(){return e(this,function(n){switch(n.label){case 0:return[4,s.getProviderState()];case 1:switch(n.sent().selectedConnection){case"mainnet":return[2,"https://ever.live/transactions/transactionDetails?id=".concat(t)];case"testnet":return[2,"https://net.ever.live/transactions/transactionDetails?id=".concat(t)];case"localnet":return[2,"http://localhost/transactions/transactionDetails?id=".concat(t)];default:return[2,"#".concat(t)]}return[2]}})})}function h(){return s.requestPermissions({permissions:["basic","accountInteraction"]})}function v(){return n(this,void 0,void 0,function(){return e(this,function(n){switch(n.label){case 0:return console.log("disconnectAction"),[4,s.disconnect()];case 1:return n.sent(),[2]}})})}function b(){return n(this,void 0,void 0,function(){return e(this,function(n){switch(n.label){case 0:return[4,s.requestPermissions({permissions:["basic","accountInteraction"]})];case 1:return n.sent(),[2]}})})}function p(){return n(this,void 0,void 0,function(){var n,t,r,c,o;return e(this,function(e){switch(e.label){case 0:return[4,s.getProviderState()];case 1:return n=e.sent(),t=n.permissions,g(r=n.selectedConnection)&&t.accountInteraction?[3,2]:(i("connect",function(n){return n.onclick=h}),m("login"),i("connect",function(n){var e=!g(r);"disabled"in n&&(n.disabled=e),n.innerText=e?"Contract not deployed into ".concat(r):"Connect with ".concat(r," for interact contract")}),[3,6]);case 2:return[4,s.getProviderState()];case 3:return c=e.sent(),[4,s.subscribe("transactionsFound",{address:g(c.selectedConnection)})];case 4:return e.sent().on("data",function(n){console.log(":",{address:n.address,transactions:n.transactions,info:n.info})}),[4,s.subscribe("contractStateChanged",{address:g(c.selectedConnection)})];case 5:e.sent().on("data",function(n){console.log("permissionsChanged:",{address:n.address,state:n.state})}),m("main"),o=t.accountInteraction,i("address",a(o.address.toString())),i("publicKey",a(o.publicKey.toString())),i("timestampAction",function(n){return n.onclick=u}),i("renderHelloWorldAction",function(n){return n.onclick=l}),i("touchAction",function(n){return n.onclick=d}),i("disconnectAction",function(n){return n.onclick=v}),e.label=6;case 6:return[2]}})})}function w(t){return n(this,void 0,void 0,function(){var n;return e(this,function(e){switch(e.label){case 0:return n='<span class="badge bg-'.concat("mainnet"===t?"success":"secondary",'">').concat(t,"</span>"),i("network",function(e){return e.innerHTML=n}),[4,p()];case 1:return e.sent(),[2]}})})}function g(n,e){return void 0===e&&(e="App"),o.default[n]&&o.default[n][e]?new r.Address(o.default[n][e]):null}function y(){return n(this,void 0,void 0,function(){var n,t;return e(this,function(e){switch(e.label){case 0:return[4,s.getProviderState()];case 1:return n=e.sent(),t=g(n.selectedConnection),[2,new s.Contract(c.default,t)]}})})}function m(n){["extension","login","main"].forEach(function(e){i(e,function(t){return t.style.display=n===e?"block":"none"})})}function C(){return n(this,void 0,void 0,function(){var t=this;return e(this,function(r){switch(r.label){case 0:return[4,s.getProviderState()];case 1:return[4,w(r.sent().selectedConnection)];case 2:return r.sent(),[4,s.subscribe("networkChanged")];case 3:return r.sent().on("data",function(n){console.log("networkChanged:",n.selectedConnection),w(n.selectedConnection)}),[4,s.subscribe("permissionsChanged")];case 4:return r.sent().on("data",function(r){return n(t,void 0,void 0,function(){return e(this,function(n){switch(n.label){case 0:return console.log("permissionsChanged:",r.permissions),[4,p()];case 1:return n.sent(),[2]}})})}),[2]}})})}function k(){return n(this,void 0,void 0,function(){return e(this,function(n){switch(n.label){case 0:return[4,s.hasProvider()];case 1:if(!n.sent())return[3,7];n.label=2;case 2:return n.trys.push([2,5,,6]),[4,s.ensureInitialized()];case 3:return n.sent(),[4,C()];case 4:return n.sent(),[3,6];case 5:throw n.sent();case 6:return[3,8];case 7:m("extension"),n.label=8;case 8:return[2]}})})}k().catch(function(n){return console.error(n)});
},{"everscale-inpage-provider":"RebX","../build/App.abi":"tKmd","../build/App.addr":"V370"}]},{},["H6gL"], null)